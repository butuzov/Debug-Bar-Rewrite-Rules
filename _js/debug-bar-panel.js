jQuery(window).ready(function(){jQuery(window).bind("resize",RRAT.url_widnow_width).bind("ready",RRAT.url_widnow_width),jQuery("#debug-menu-link-Debug_Bar_Rewrite_Rules").bind("click",RRAT.url_widnow_width).bind("click",function(){window.setTimeout(function(){RRAT.url_widnow_width()},100)}),jQuery("#dbrr h2").bind("click",function(){window.location.href="#"+jQuery(this).attr("for")}),jQuery(".mono.pattern_search").bind("focus",function(){jQuery(this).parent().addClass("active"),jQuery("#rewrite_rules_array_table thead tr th.col-match").length||(jQuery("<th />").addClass("col-match").css("width","30%").text(RRAT.__matches_col_title).appendTo(jQuery("#rewrite_rules_array_table thead tr")).parent().find("th.col-data").css("width","35%"),jQuery("<td />").addClass("col-match").html(" ").appendTo(jQuery("#rewrite_rules_array_table tbody tr")))}).bind("blur",function(){""==jQuery.trim(jQuery(this).val())&&jQuery(".col-match").length&&(jQuery(this).parent().removeClass("active"),jQuery(".col-match").remove())}).bind("keyup",RRAT._filter_match).bind("keyup",RRAT._filter_sarched).bind("keypress",RRAT._filter_match),jQuery(".mono.pattern_domain").bind("click",function(){jQuery(".mono.pattern_search").focus()}),jQuery(".mono.matches_field").bind("focus",function(){""!=jQuery.trim(jQuery(".pattern_search").val())&&jQuery(".col-match").length&&(jQuery(".filter_url").removeClass("active"),jQuery(".col-match").remove(),jQuery("th.col-data").css({width:"50%"}))}).bind("keypress",RRAT._search_for_match).bind("keyup",RRAT._search_for_match),jQuery(".flush_rewrite_rules_trigger").monitor("on","click",function(){return jQuery(this).find(".spinner").show(),jQuery.post(RRAT.ajax,{action:"DEBUG_BAR_REWRITE_RULES_ajax_flush_rewrite_rules",request:"json"},function(e){if(jQuery(".flush_rewrite_rules_trigger .spinner").hide(),"undefined"!=typeof e.message)console.log("OOPS! Something gone wrong...");else{if(jQuery(".mono.pattern_search").val(""),jQuery(".filter_url.active").removeClass("active"),1==jQuery("h2[for=dbrr_rewrite_rules_array]").length){var r=jQuery("h2[for=dbrr_rewrite_rules_array]").html();jQuery("h2[for=dbrr_rewrite_rules_array]").html(r.split("</span>")[0]+"</span>"+e.rewrite_rules_array_n),jQuery("#rewrite_rules_array_holder").html(e.rewrite_rules_array)}if(0==e.dbrr_rewrites_filters_n)jQuery("h2[for=dbrr_rewrites_filters]").remove(),jQuery("#dbrr_rewrites_filters_holder").html("");else{jQuery("h2[for=dbrr_rewrites_filters]").remove(),0==jQuery("h2[for=dbrr_rewrites_filters]").length&&jQuery("<h2 for='dbrr_rewrites_filters'><span> </span> 0 </h2>").insertAfter("h2[for=dbrr_rewrite_rules_array]");var t=jQuery("h2[for=dbrr_rewrites_filters]").html();jQuery("h2[for=dbrr_rewrites_filters]").html(t.split("</span>")[0]+"</span>"+e.dbrr_rewrites_filters_n),jQuery("#dbrr_rewrites_filters_holder").html(e.dbrr_rewrites_filters)}RRAT.el=jQuery("#rewrite_rules_array_table tbody tr")}},"json"),!1})});var RRAT={url_widnow_width:function(){width=jQuery("<span />").attr("id","http_width_dbg").text(RRAT.domain).css("padding",jQuery("inpit.mono.pattern_domain").css("padding")).addClass("mono").appendTo("body").outerWidth()+10,jQuery("#http_width_dbg").remove();var e=jQuery("none"!=jQuery("#querylist").css("display")&&1==jQuery("body.tools_page_permalinks").length?"body.tools_page_permalinks #wpbody-content":"#dbrr");jQuery(".mono.pattern_domain",e).css("width",width);var r=jQuery(".filter_url",e).width()-(width+10);jQuery(".mono.pattern_search",e).css("width",r>100?r:100)},parse_url:function(e){var r=document.createElement("a");r.href=e;var t=/(\/\/)(.+?)((:(.+?))?)@/i;if(t.exec(e)){var a=t.exec(e);"string"==typeof a[2]&&a[2].length>0&&(r.user=a[2]),"string"==typeof a[5]&&a[5].length>0&&(r.pass=a[5])}var s=new Object,i=["scheme","host","port","user","pass","path","query","fragment"],n=["protocol","hostname","port","user","pass","pathname","search","hash"];return n.forEach(function(e,t){if("string"==typeof r[e]&&r[e].length>0)switch(e){case"protocol":s[i[t]]=r[e].replace(":","");break;case"hash":s[i[t]]=r[e].replace("#","");break;case"pathname":"/"!=r[e]&&(s[i[t]]=r[e]);break;default:s[i[t]]=r[e]}}),s},_search_for_match:function(e){return 13==e.which?(e.preventDefault(),!1):(RRAT.search_for_match=jQuery.trim(jQuery(this).val()),RRAT._tbl(),""!=RRAT.search_for_match&&RRAT.el.each(function(){-1==jQuery(this).text().indexOf(RRAT.search_for_match)?jQuery(this).addClass("hidden"):jQuery("td",jQuery(this)).each(function(){text=jQuery(this).text().replace(RRAT.search_for_match,"<span>"+RRAT.search_for_match+"</span>"),jQuery(this).html(text)})}),void RRAT._tbl_zebra())},_filter_sarched:function(e){13==e.which&&e.preventDefault(),RRAT._tbl(),RRAT._tbl_zebra(),RRAT.el.each(function(){jQuery("td:eq(0),td:eq(1)",jQuery(this)).each(function(){jQuery(this).html(jQuery(this).text())}),jQuery("td:eq(2)",jQuery(this)).html("")}),""!=jQuery.trim(jQuery(".mono.pattern_search").val())&&("undefined"==typeof RRAT.rules&&(RRAT.rules={},RRAT.el.each(function(){RRAT.rules[jQuery(this).attr("id")]={rule:jQuery("td:eq(0)",jQuery(this)).text(),match:jQuery("td:eq(1)",jQuery(this)).text()}})),jQuery.ajax({async:!1,url:RRAT.validator,crossDomain:!0,dataType:"json",type:"POST",data:{rules:RRAT.rules,search:jQuery(".mono.pattern_search").val(),use_verbose_page_rules:RRAT.use_verbose_page_rules}}).done(function(e){RRAT._tbl(),RRAT.el.each(function(r){0==e.rules[r+1].result?jQuery(this).addClass("hidden"):(RRAT.current=RRAT.el.eq(r),console.log(e.rules[r+1].vars),"undefined"!=typeof e.rules[r+1].vars&&jQuery.each(e.rules[r+1].vars,function(e,r){jQuery("td:eq(2)",RRAT.current).append("<div><strong>"+e+"</strong> : "+r+"</div>")}))}),RRAT._tbl_zebra()}))},_filter_match:function(e){if("undefined"==typeof RRAT.base&&(RRAT.base=RRAT.parse_url(RRAT.domain)),13==e.which&&""!=jQuery.trim(jQuery(this).val()))return e.preventDefault(),!1;var r=RRAT.parse_url(jQuery(".mono.pattern_search").val());jQuery.each(["scheme","://","host","port","path"],function(e,t){val=jQuery(".mono.pattern_search").val().split("?")[0].split("#")[0],o=val,"string"==typeof r[t]&&r[t]==RRAT.base[t]&&-1!=val.indexOf(r[t])?val=val.substring(val.indexOf(r[t])+r[t].length):"://"==t&&-1!=val.indexOf(t)?val=val.substring(val.indexOf(t)+t.length):"path"==t&&0==val.indexOf(RRAT.base[t])&&(val=val.substring(val.indexOf(RRAT.base[t])+RRAT.base[t].length)),val=jQuery.trim(val),o!=val&&jQuery(".mono.pattern_search").val(val)})},_tbl:function(){RRAT.el.removeClass("hidden"),RRAT.el.removeClass("alt"),RRAT.el.each(function(){jQuery("td",jQuery(this)).each(function(){jQuery(this).html(jQuery(this).text())})})},_tbl_zebra:function(){RRAT.el.filter(":visible").each(function(e){(e+2)%2==1&&jQuery(this).addClass("alt")})}};